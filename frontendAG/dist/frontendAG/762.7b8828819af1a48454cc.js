"use strict";(self.webpackChunkfrontend_ag=self.webpackChunkfrontend_ag||[]).push([[762],{1834:(x,P,o)=>{o.d(P,{D:()=>A});var n=o(8741),u=o(5257),g=o(3342),p=o(2340),t=o(7716),m=o(42),h=o(9344),d=o(1615),e=o(3980),f=o(5218),w=o(8583),I=o(2608);function b(_,E){if(1&_){const i=t.EpF();t.TgZ(0,"div",21),t.TgZ(1,"button",22),t.NdJ("click",function(){return t.CHM(i),t.oxw().onDeletePost()}),t._UZ(2,"svg-icon",23),t.qZA(),t.qZA()}}function C(_,E){if(1&_&&(t.TgZ(0,"div",24),t._UZ(1,"img",25),t.qZA()),2&_){const i=t.oxw();t.xp6(1),t.s9C("src",i.url+"cdn/post/"+i.image,t.LSH)}}const y=function(_){return["/profile",_]},D=function(_){return{myRed:_}},U=function(_){return["/post",_]};let A=(()=>{class _{constructor(i,r,O,L){this.apollo=i,this.toastr=r,this.postService=O,this.store=L,this.url=p.N.apiUrl,this.isCommented=!1}ngOnInit(){this.loadLiked()}ngOnDestroy(){}loadLiked(){try{const i=n.Ps`
      query likeToPostByUser($post:String!,$user:String!){
        likeToPostByUser(post_Owner:$post,user_Action:$user) {
          id
          like
        }
      }
    `;this.apollo.watchQuery({query:i,variables:{post:this.idPost,user:this.idUser},fetchPolicy:"network-only"}).valueChanges.pipe((0,u.q)(1),(0,g.b)(({data:r})=>{null!==r.likeToPostByUser&&(this.isLiked=!0,this.idLiked=r.likeToPostByUser.id)},r=>{console.log("there was an error sending the query",r)})).subscribe()}catch(i){console.log(i)}}LikerDislikear(){try{if(this.isLiked){const i=n.Ps`
        mutation deleteLike($ID:String!,$POST:String!,$NLIKE:String!,$USER_POST:String!,$USER_SESSION:String!) {
          deleteLike(id:$ID,post_Owner:$POST,nLikeCount:$NLIKE,user_Post_Owner:$USER_POST,user_Action:$USER_SESSION)
          }
        `;this.apollo.mutate({mutation:i,variables:{ID:this.idLiked,POST:this.idPost,NLIKE:(Number(this.nLike)-1).toString(),USER_POST:this.idUserPost,USER_SESSION:this.idUser}}).pipe((0,u.q)(1),(0,g.b)(({})=>{this.idLiked="",this.isLiked=!1,this.nLike=(Number(this.nLike)-1).toString(),window.location.reload()},r=>{console.log("there was an error sending the query",r)})).subscribe()}else{const i=n.Ps`
      mutation addLike($post:String!,$user:String!,$nlike:String!,$USER_POST:String!) {
          addLike(like:"true",post_Owner:$post,user_Action:$user,nLikeCount:$nlike,user_Post_Owner:$USER_POST){
            id
          }
        }
      `;this.apollo.mutate({mutation:i,variables:{post:this.idPost,user:this.idUser,nlike:(Number(this.nLike)+1).toString(),USER_POST:this.idUserPost}}).pipe((0,u.q)(1),(0,g.b)(({data:r})=>{this.idLiked=r.addLike.id,this.isLiked=!0,this.nLike=(Number(this.nLike)+1).toString(),window.location.reload()},r=>{console.log("there was an error sending the query",r)})).subscribe()}}catch(i){console.log(i)}}onDeletePost(){try{const i=n.Ps`
      mutation deletePost($deletePostId: String!){
          deletePost(id: $deletePostId)
        }
      `;this.apollo.mutate({mutation:i,variables:{deletePostId:this.idPost}}).pipe((0,u.q)(1),(0,g.b)(({})=>{this.postService.clearPostByUserData(),this.postService.getPostByUserData(this.idUser.toString(),"0"),this.toastr.success("post deleted successfully","success!",{closeButton:!0,progressBar:!0,timeOut:1500})},r=>{console.log("there was an error sending the query",r)})).subscribe()}catch(i){console.log(i)}}}return _.\u0275fac=function(i){return new(i||_)(t.Y36(m._M),t.Y36(h._W),t.Y36(d.L),t.Y36(e.yh))},_.\u0275cmp=t.Xpm({type:_,selectors:[["app-card-post"]],inputs:{isOwner:"isOwner",display_name:"display_name",idUser:"idUser",idUserPost:"idUserPost",username:"username",imageUser:"imageUser",idPost:"idPost",title:"title",body:"body",image:"image",nLike:"nLike",nComment:"nComment",tags:"tags"},decls:31,vars:18,consts:[[1,"w-full","border-b-2","border-gray-500"],[1,"flex-col"],[1,"flex","p-4","pb-0","w-full","relative"],[1,"flex-shrink-0","group","block"],[1,"flex","items-center"],["alt","",1,"inline-block","h-10","w-10","rounded-full",3,"src"],[1,"ml-3"],[1,"text-base","hover:underline","cursor-pointer","leading-6","font-medium","text-white",3,"routerLink"],[1,"text-sm","leading-5","font-medium","transition","ease-in-out","duration-100"],["class","flex absolute right-2 ",4,"ngIf"],[1,"w-full","py-2","px-6"],[1,"font-semibold","text-xl","text-white"],[1,"text-base","overflow-y-auto","font-medium","text-gray-300"],["class"," px-6 pt-3",4,"ngIf"],[1,"grid","grid-cols-2","justify-center","py-3","w-full"],[1,"flex","justify-center"],[1,"flex","hover:text-red-600","text-white",3,"ngClass","click"],["key","heart","color","hover:text-red-600","fontSize","28px",1,""],[1,"pl-3"],[1,"flex","hover:text-green-600","text-white",3,"routerLink"],["key","comments","color","hover:text-red-600","fontSize","28px",1,""],[1,"flex","absolute","right-2"],[1,"flex","hover:text-red-600","text-white","px-2",3,"click"],["key","trash-can","color","hover:text-red-600","fontSize","28px",1,""],[1,"px-6","pt-3"],["alt","",1,"object-contain","max-h-screen","m","w-full",3,"src"]],template:function(i,r){1&i&&(t.TgZ(0,"div",0),t.TgZ(1,"a"),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t.TgZ(4,"a",3),t.TgZ(5,"div",4),t.TgZ(6,"div"),t._UZ(7,"img",5),t.qZA(),t.TgZ(8,"div",6),t.TgZ(9,"p",7),t._uU(10),t.TgZ(11,"span",8),t._uU(12),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(13,b,3,0,"div",9),t.qZA(),t.TgZ(14,"div",10),t.TgZ(15,"span",11),t._uU(16),t.qZA(),t.TgZ(17,"p",12),t._uU(18),t.qZA(),t.qZA(),t.YNc(19,C,2,1,"div",13),t.TgZ(20,"div",14),t.TgZ(21,"div",15),t.TgZ(22,"button",16),t.NdJ("click",function(){return r.LikerDislikear()}),t._UZ(23,"svg-icon",17),t.TgZ(24,"h2",18),t._uU(25),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"div",15),t.TgZ(27,"a",19),t._UZ(28,"svg-icon",20),t.TgZ(29,"h2",18),t._uU(30),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(7),t.s9C("src",r.url+"cdn/user/"+r.imageUser,t.LSH),t.xp6(2),t.Q6J("routerLink",t.VKq(12,y,r.idUserPost)),t.xp6(1),t.hij(" ",r.display_name," "),t.xp6(2),t.hij(" @",r.username," "),t.xp6(1),t.Q6J("ngIf",r.isOwner),t.xp6(3),t.Oqu(r.title),t.xp6(2),t.Oqu(r.body),t.xp6(1),t.Q6J("ngIf",""!=r.image),t.xp6(3),t.Q6J("ngClass",t.VKq(14,D,r.isLiked)),t.xp6(3),t.Oqu(r.nLike),t.xp6(2),t.Q6J("routerLink",t.VKq(16,U,r.idPost)),t.xp6(3),t.Oqu(r.nComment))},directives:[f.rH,w.O5,w.mk,I.bk,f.yS],styles:[".myRed[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgba(220,38,38,var(--tw-text-opacity))}.myHover[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgba(255,255,255,var(--tw-text-opacity))}"]}),_})()},4253:(x,P,o)=>{o.d(P,{m:()=>h});var n=o(8583),u=o(5218),g=o(2608),p=o(5128),t=o(3980),m=o(7716);let h=(()=>{class d{}return d.\u0275fac=function(f){return new(f||d)},d.\u0275mod=m.oAB({type:d}),d.\u0275inj=m.cJS({imports:[[n.ez,u.Bz,g.Kz,t.Aw.forFeature(p.u2,p.ZP)]]}),d})()},8559:(x,P,o)=>{o.d(P,{Y:()=>L});var n=o(665),u=o(3506),g=o(8741),p=o(205),t=o(5257),m=o(3342),h=o(5304),d=o(2340),e=o(7716),f=o(42),w=o(9344),I=o(1841),b=o(1615),C=o(8583);function y(a,c){if(1&a){const s=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){return e.CHM(s),e.oxw().onImageRequired()}),e._uU(1),e.qZA()}if(2&a){const s=e.oxw();e.xp6(1),e.hij(" ",s.withImage?"No image":"Add image"," ")}}function D(a,c){1&a&&(e.TgZ(0,"span",18),e._uU(1," Invalid text for title!. "),e.qZA())}function U(a,c){1&a&&(e.TgZ(0,"span",18),e._uU(1," Invalid text for body!. "),e.qZA())}function A(a,c){1&a&&e._UZ(0,"file-upload",19),2&a&&e.Q6J("animation",!0)}function _(a,c){1&a&&(e.TgZ(0,"span",18),e._uU(1," Invalid file for image!. "),e.qZA())}function E(a,c){if(1&a&&e._UZ(0,"img",20),2&a){const s=e.oxw(2);e.Q6J("src",s.filePath,e.LSH)}}function i(a,c){1&a&&(e.TgZ(0,"span",18),e._uU(1," Invalid text for tags!. "),e.qZA())}const r=function(){return[]};function O(a,c){if(1&a){const s=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"form",6),e.NdJ("ngSubmit",function(){return e.CHM(s),e.oxw().onCreatePost()}),e.TgZ(2,"div",7),e.TgZ(3,"div",8),e._UZ(4,"input",9),e.YNc(5,D,2,0,"span",10),e.qZA(),e.TgZ(6,"div",8),e.TgZ(7,"textarea",11),e._uU(8,"                "),e.qZA(),e.YNc(9,U,2,0,"span",10),e.qZA(),e.TgZ(10,"div",12),e.YNc(11,A,1,1,"file-upload",13),e.YNc(12,_,2,0,"span",10),e.YNc(13,E,1,1,"img",14),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"input",15),e.YNc(16,i,2,0,"span",10),e.qZA(),e.qZA(),e.TgZ(17,"div",16),e.TgZ(18,"button",17),e._uU(19,"Create Post"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const s=e.oxw();e.xp6(1),e.Q6J("formGroup",s.formNewPost),e.xp6(4),e.Q6J("ngIf",s.formNewPost.controls.title.invalid&&""!=s.formNewPost.controls.title.value),e.xp6(4),e.Q6J("ngIf",s.formNewPost.controls.body.invalid&&""!=s.formNewPost.controls.body.value),e.xp6(2),e.Q6J("ngIf",s.withImage),e.xp6(1),e.Q6J("ngIf",s.formNewPost.controls.files.invalid&&s.formNewPost.controls.files.value!=e.DdM(7,r)),e.xp6(1),e.Q6J("ngIf","null"!=s.filePath),e.xp6(3),e.Q6J("ngIf",s.formNewPost.controls.tags.invalid&&""!=s.formNewPost.controls.tags.value)}}let L=(()=>{class a{constructor(s,l,v,T){this.apollo=s,this.toastr=l,this.http=v,this.postService=T,this.showForm=!1,this.withImage=!1,this.filePath="null",this.newImage="",this.formNewPost=new n.cw({title:new n.NI("",[n.kI.required,n.kI.maxLength(25),n.kI.minLength(1),n.kI.pattern(d.N.TextValidation)]),body:new n.NI("",[n.kI.required,n.kI.maxLength(100),n.kI.minLength(1),n.kI.pattern(d.N.TextValidation)]),files:new n.NI(null,u.Fz.filesLimit(1)),tags:new n.NI("",[n.kI.required,n.kI.maxLength(25),n.kI.minLength(1),n.kI.pattern(d.N.TextValidation)])})}ngOnInit(){this.previewImage=this.formNewPost.controls.files.valueChanges.subscribe(s=>{try{if(void 0===s[0])this.filePath="null";else if("image/png"==s[0].type||"image/jpg"==s[0].type||"image/jpeg"==s[0].type){const l=new FileReader;l.onload=()=>{this.filePath=l.result},l.readAsDataURL(s[0])}}catch(l){}})}onShowform(){this.showForm=!this.showForm}onImageRequired(){this.withImage=!this.withImage}onCreatePost(){try{this.withImage?this.formNewPost.valid&&0!==this.formNewPost.controls.files.value.length?this.onPostWithImage():this.toastr.warning("Invalid data","warning!",{closeButton:!0,progressBar:!0,timeOut:1500}):this.formNewPost.controls.title.valid||this.formNewPost.controls.body.valid||this.formNewPost.controls.tags.valid?this.onPostNoImage():this.toastr.warning("Invalid data","warning!",{closeButton:!0,progressBar:!0,timeOut:1500})}catch(s){}}onPostNoImage(){const s=g.Ps`
      mutation addPost($TITLE: String!,$BODY:String!,$IMAGE:String!,$TAGS:String!,$USER:String!){ 
        addPost(title:$TITLE,body:$BODY,image:$IMAGE,nLike:"0",nComment:"0",tags:$TAGS,user_Owner:$USER){
          id
          title
          body
          image
          nLike
          nComment
          tags
          user_Owner{
          id
          username
          image
          display_name
          }
        }
      }
    `;this.apollo.mutate({mutation:s,variables:{TITLE:this.formNewPost.controls.title.value,BODY:this.formNewPost.controls.body.value,IMAGE:"",TAGS:this.formNewPost.controls.tags.value,USER:this.idUserOwner}}).pipe((0,t.q)(1),(0,m.b)(({data:l})=>{this.toastr.success("infor updated","success!",{closeButton:!0,progressBar:!0,timeOut:1500}),this.postService.addPostFeedData(l.addPost),this.postService.addPostProfileData(l.addPost),console.log(l),this.formNewPost.reset(),this.formNewPost.controls.files.setValue([]),this.formNewPost.controls.title.setValue(""),this.formNewPost.controls.body.setValue(""),this.formNewPost.controls.tags.setValue("")},l=>{this.toastr.error("somethings is wrong :C","error!",{closeButton:!0,progressBar:!0,timeOut:1500}),console.log("there was an error sending the query",l)})).subscribe()}onPostWithImage(){let s=new FormData;s.append("image",this.formNewPost.controls.files.value[0]),this.http.post(d.N.apiUrl+"post",s).pipe((0,t.q)(1),(0,h.K)(this.handleError)).subscribe({next:l=>{this.newImage=l.name;const v=g.Ps`
          mutation addPost($TITLE: String!,$BODY:String!,$IMAGE:String!,$TAGS:String!,$USER:String!){ 
            addPost(title:$TITLE,body:$BODY,image:$IMAGE,nLike:"0",nComment:"0",tags:$TAGS,user_Owner:$USER){
              id
              title
              body
              image
              nLike
              nComment
              tags
              user_Owner{
              id
              username
              image
              display_name
              }
            }
          }
        `;this.apollo.mutate({mutation:v,variables:{TITLE:this.formNewPost.controls.title.value,BODY:this.formNewPost.controls.body.value,IMAGE:this.newImage,TAGS:this.formNewPost.controls.tags.value,USER:this.idUserOwner}}).pipe((0,t.q)(1),(0,m.b)(({data:T})=>{this.toastr.success("infor updated","success!",{closeButton:!0,progressBar:!0,timeOut:1500}),this.postService.addPostFeedData(T.addPost),this.postService.addPostProfileData(T.addPost),this.formNewPost.reset(),this.formNewPost.controls.files.setValue([]),this.formNewPost.controls.title.setValue(""),this.formNewPost.controls.body.setValue(""),this.formNewPost.controls.tags.setValue("")},T=>{this.toastr.error("somethings is wrong :C","error!",{closeButton:!0,progressBar:!0,timeOut:1500}),console.log("there was an error sending the query",T)})).subscribe()},error:l=>{console.error("There was an error!",l)}})}ngOnDestroy(){this.previewImage.unsubscribe()}handleError(s){return 0===s.status?console.error("An error occurred:",s.error):console.error(`Backend returned code ${s.status}, body was: `,s.error),(0,p._)("Something bad happened; please try again later.")}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(f._M),e.Y36(w._W),e.Y36(I.eN),e.Y36(b.L))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-new-post"]],inputs:{idUserOwner:"idUserOwner"},decls:5,vars:3,consts:[[1,"flex","justify-center","my-1"],[1,"right-4","mt-2","p-2","pl-5","pr-5","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"click"],["class","right-4 mt-2 p-2 ml-5 pl-5 pr-5 bg-transparent border-2 border-blue-500 text-blue-500 text-lg rounded-full hover:bg-blue-500 hover:text-gray-100 focus:border-4 focus:border-blue-300",3,"click",4,"ngIf"],["class"," w-full p-3 bg-dim-700 border-b-2 border-gray-600 ",4,"ngIf"],[1,"right-4","mt-2","p-2","ml-5","pl-5","pr-5","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"click"],[1,"w-full","p-3","bg-dim-700","border-b-2","border-gray-600"],[3,"formGroup","ngSubmit"],[1,"flex-col"],[1,"py-1"],["formControlName","title","type","text","name","default","placeholder","title post",1,"px-4","py-2","w-full","rounded-lg","border","border-gray-300","focus:outline-none","focus:ring-2","focus:ring-gray-200"],["class","flex items-center font-medium tracking-wide text-red-500 text-xs mt-1 ml-1",4,"ngIf"],["formControlName","body","type","text","name","default","placeholder","body post",1,"px-4","py-2","w-full","h-16","rounded-lg","border","border-gray-300","focus:outline-none","focus:ring-2","focus:ring-gray-200"],[1,""],["class","w-full","formControlName","files","multiple","false","accept","image/*","maxsize","10MB",3,"animation",4,"ngIf"],["class","w-full object-scale-down max-h-48 m-2","alt","image-user",3,"src",4,"ngIf"],["formControlName","tags","type","text","name","default","placeholder","tags post",1,"px-4","py-2","w-full","rounded-lg","border","border-gray-300","focus:outline-none","focus:ring-2","focus:ring-gray-200"],[1,"flex"],["type","submit",1,"py-2","px-4","text-white","font-bold","rounded-md","bg-indigo-400","hover:bg-blue-500"],[1,"flex","items-center","font-medium","tracking-wide","text-red-500","text-xs","mt-1","ml-1"],["formControlName","files","multiple","false","accept","image/*","maxsize","10MB",1,"w-full",3,"animation"],["alt","image-user",1,"w-full","object-scale-down","max-h-48","m-2",3,"src"]],template:function(s,l){1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return l.onShowform()}),e._uU(2),e.qZA(),e.YNc(3,y,2,1,"button",2),e.qZA(),e.YNc(4,O,20,8,"div",3)),2&s&&(e.xp6(2),e.hij(" ",l.showForm?"Hide":"New post"," "),e.xp6(1),e.Q6J("ngIf",l.showForm),e.xp6(1),e.Q6J("ngIf",l.showForm))},directives:[C.O5,n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,u.Yr,u.wf,u.AJ,u.Eb],styles:[".bg-disabled[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgba(123,121,125,var(--tw-bg-opacity))}"]}),a})()},4998:(x,P,o)=>{o.d(P,{H:()=>h});var n=o(8583),u=o(5218),g=o(2608),p=o(665),t=o(3506),m=o(7716);let h=(()=>{class d{}return d.\u0275fac=function(f){return new(f||d)},d.\u0275mod=m.oAB({type:d}),d.\u0275inj=m.cJS({imports:[[n.ez,u.Bz,g.Kz,p.UX,t.Ob]]}),d})()}}]);