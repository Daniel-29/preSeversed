"use strict";(self.webpackChunkfrontend_ag=self.webpackChunkfrontend_ag||[]).push([[576],{5576:(Lt,C,l)=>{l.r(C),l.d(C,{NotiModule:()=>Kt});var m=l(8583),n=l(7716),M=l(5917),H=l(7574),P=l(9796),I=l(9105),v=l(8002);function D(t,e,i,o){return(0,I.m)(i)&&(o=i,i=void 0),o?D(t,e,i).pipe((0,v.U)(r=>(0,P.k)(r)?o(...r):o(r))):new H.y(r=>{N(t,e,function(a){r.next(arguments.length>1?Array.prototype.slice.call(arguments):a)},r,i)})}function N(t,e,i,o,r){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const a=t;t.addEventListener(e,i,r),s=()=>a.removeEventListener(e,i,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const a=t;t.on(e,i),s=()=>a.off(e,i)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const a=t;t.addListener(e,i),s=()=>a.removeListener(e,i)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let a=0,c=t.length;a<c;a++)N(t[a],e,i,o,r)}o.add(s)}var K=l(9773),h=l(3342),B=l(5435),L=l(7393),Y=l(3637);const Z={leading:!0,trailing:!1};class J{constructor(e,i,o,r){this.duration=e,this.scheduler=i,this.leading=o,this.trailing=r}call(e,i){return i.subscribe(new G(e,this.duration,this.scheduler,this.leading,this.trailing))}}class G extends L.L{constructor(e,i,o,r,s){super(e),this.duration=i,this.scheduler=o,this.leading=r,this.trailing=s,this._hasTrailingValue=!1,this._trailingValue=null}_next(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(k,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))}_complete(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}clearThrottle(){const e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)}}function k(t){const{subscriber:e}=t;e.clearThrottle()}function X(t,e,i,o){const r=window&&!!window.document&&window.document.documentElement;let s=r&&e?window:i;if(t&&(s=t&&r&&"string"==typeof t?function(t,e,i){return(i?window.document:e).querySelector(t)}(t,i.nativeElement,o):t,!s))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return s}function T(t){return t&&!t.firstChange}const q={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},_={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"};class tt{constructor(e=!0){this.vertical=e,this.propsMap=e?q:_}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}}function ot(t){return["Window","global"].some(i=>Object.prototype.toString.call(t).includes(i))}function b(t,e){return t?e.document.documentElement:null}function U(t,e){const i=function({container:t,isWindow:e,axis:i}){const{offsetHeightKey:o,clientHeightKey:r}=E(i);return A(t,e,o,r)}(e);return e.isWindow?function(t,e,i){const{axis:o,container:r,isWindow:s}=i,{offsetHeightKey:a,clientHeightKey:c}=E(o),p=t+W(b(s,r),o,s),u=A(e.nativeElement,s,a,c),g=function(t,e,i){const o=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[o]+W(t,e,i)}(e.nativeElement,o,s)+u;return{height:t,scrolled:p,totalToScroll:g,isWindow:s}}(i,t,e):function(t,e,i){const{axis:o,container:r}=i;return{height:t,scrolled:r[o.scrollTopKey()],totalToScroll:r[o.scrollHeightKey()],isWindow:!1}}(i,0,e)}function E(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function A(t,e,i,o){if(isNaN(t[i])){const r=b(e,t);return r?r[o]:0}return t[i]}function W(t,e,i){const o=e.pageYOffsetKey(),r=e.scrollTopKey(),s=e.offsetTopKey();return isNaN(window.pageYOffset)?b(i,t)[r]:t.ownerDocument?t.ownerDocument.defaultView[o]:t[s]}function ct(t,e,i){let o,r;if(t.totalToScroll<=0)return!1;const s=t.isWindow?t.scrolled:t.height+t.scrolled;return i?(o=(t.totalToScroll-s)/t.totalToScroll,r=e.down/10):(o=t.scrolled/(t.scrolled+(t.totalToScroll-s)),r=e.up/10),o<=r}class ht{constructor({totalToScroll:e}){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=e}updateScrollPosition(e){return this.lastScrollPosition=e}updateTotalToScroll(e){this.lastTotalToScroll!==e&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=e)}updateScroll(e,i){this.updateScrollPosition(e),this.updateTotalToScroll(i)}updateTriggeredFlag(e,i){i?this.triggered.down=e:this.triggered.up=e}isTriggeredScroll(e,i){return i?this.triggered.down===e:this.triggered.up===e}}function ft(t){const{scrollContainer:e,scrollWindow:i,element:o,fromRoot:r}=t,s=function({windowElement:t,axis:e}){return function(t,e){const i=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return Object.assign(Object.assign({},t),{container:i})}({axis:e,isWindow:ot(t)},t)}({axis:new tt(!t.horizontal),windowElement:X(e,i,o,r)}),a=new ht({totalToScroll:U(o,s)}),p={up:t.upDistance,down:t.downDistance};return function(t){let e=D(t.container,"scroll");return t.throttle&&(e=e.pipe(function(t,e=Y.P,i=Z){return o=>o.lift(new J(t,e,i.leading,i.trailing))}(t.throttle))),e}({container:s.container,throttle:t.throttle}).pipe((0,K.zg)(()=>(0,M.of)(U(o,s))),(0,v.U)(u=>function(t,e,i){const{scrollDown:o,fire:r}=function(t,e,i){const o=function(t,e){return t<e.scrolled}(t,e);return{fire:ct(e,i,o),scrollDown:o}}(t,e,i);return{scrollDown:o,fire:r,stats:e}}(a.lastScrollPosition,u,p)),(0,h.b)(({stats:u})=>a.updateScroll(u.scrolled,u.totalToScroll)),(0,B.h)(({fire:u,scrollDown:g,stats:{totalToScroll:Bt}})=>function(t,e,i){return!!(t&&e||!i&&e)}(t.alwaysCallback,u,a.isTriggeredScroll(Bt,g))),(0,h.b)(({scrollDown:u,stats:{totalToScroll:g}})=>{a.updateTriggeredFlag(g,u)}),(0,v.U)(mt))}function mt(t){const{scrollDown:e,stats:{scrolled:i}}=t;return{type:e?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:i}}}let yt=(()=>{class t{constructor(i,o){this.element=i,this.zone=o,this.scrolled=new n.vpe,this.scrolledUp=new n.vpe,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:i,infiniteScrollDisabled:o,infiniteScrollDistance:r}){const s=T(i),a=T(o),c=T(r),p=!a&&!this.infiniteScrollDisabled||a&&!o.currentValue||c;(s||a||c)&&(this.destroyScroller(),p&&this.setup())}setup(){"undefined"!=typeof window&&this.zone.runOutsideAngular(()=>{this.disposeScroller=ft({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(i=>this.zone.run(()=>this.handleOnScroll(i)))})}handleOnScroll({type:i,payload:o}){switch(i){case"[NGX_ISE] DOWN":return this.scrolled.emit(o);case"[NGX_ISE] UP":return this.scrolledUp.emit(o);default:return}}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}return t.\u0275fac=function(i){return new(i||t)(n.Y36(n.SBq),n.Y36(n.R0b))},t.\u0275dir=n.lG2({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[n.TTD]}),t})(),St=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({providers:[],imports:[[]]}),t})();var S=l(5218),vt=l(6686),f=l(3980),w=l(5858),d=l(5128),x=l(42),Tt=l(8741),bt=l(6215),wt=l(5257),Ct=l(2996),Dt=l(7057);let Nt=(()=>{class t{constructor(i){this.apollo=i,this.profileNotisSubject=new bt.X([]),this.NotisByUser$=this.profileNotisSubject.asObservable()}getNotisByUserData(i,o){try{const r=Tt.Ps`
      query notificationsByUser($ID:String!,$PAGE:String!){ 
        notificationsByUser(user_Owner:$ID,page:$PAGE){
          id
          unicodeNoti
          user_Writer{
            id
            username
            display_name
            image
          }
        }
      }
    `;this.apollo.watchQuery({query:r,variables:{ID:i,PAGE:o},fetchPolicy:"network-only"}).valueChanges.pipe((0,wt.q)(1),(0,Ct.j)("data","notificationsByUser"),(0,Dt.M)(this.NotisByUser$),(0,h.b)(([s,a])=>{this.profileNotisSubject.next([...a,...s])},s=>{console.log("there was an error sending the query",s)})).subscribe()}catch(r){console.log(r)}}}return t.\u0275fac=function(i){return new(i||t)(n.LFG(x._M))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Zt=l(5824),Ut=l(8391),Et=l(9960),At=l(2340);const Wt=function(t){return["/profile",t]};let xt=(()=>{class t{constructor(){this.url=At.N.apiUrl,this.body="test"}ngOnInit(){switch(this.unicode){case"1":this.body=this.username+" follow you";break;case"2":this.body=this.username+" stopped following you";break;case"3":this.body=this.username+" liked your post";break;case"4":this.body=this.username+" removed his like from your post";break;case"5":this.body=this.username+" commented on your post";break;case"6":this.body=this.username+" sent you a message ";break;case"7":this.body=this.username+" commented on your post"}}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-card-noti"]],inputs:{id:"id",username:"username",display_name:"display_name",image:"image",unicode:"unicode"},decls:16,vars:7,consts:[[1,"w-full","border-b-2","border-gray-500"],[1,"flex-col"],[1,"flex","p-4","pb-0","w-full"],[1,"flex-shrink-0","group","block"],[1,"flex","items-center"],["alt","",1,"inline-block","h-10","w-10","rounded-full",3,"src"],[1,"ml-3"],[1,"text-base","hover:underline","cursor-pointer","leading-6","font-medium","text-white",3,"routerLink"],[1,"text-sm","leading-5","font-medium","text-gray-400","group-hover:text-gray-300","transition","ease-in-out","duration-150"],[1,"w-full","py-2","px-6"],[1,"text-base","overflow-y-auto","font-medium","text-gray-400"]],template:function(i,o){1&i&&(n.TgZ(0,"div",0),n.TgZ(1,"a"),n.TgZ(2,"div",1),n.TgZ(3,"div",2),n.TgZ(4,"a",3),n.TgZ(5,"div",4),n.TgZ(6,"div"),n._UZ(7,"img",5),n.qZA(),n.TgZ(8,"div",6),n.TgZ(9,"p",7),n._uU(10),n.TgZ(11,"span",8),n._uU(12),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(13,"div",9),n.TgZ(14,"p",10),n._uU(15),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&i&&(n.xp6(7),n.s9C("src",o.url+"cdn/user/"+o.image,n.LSH),n.xp6(2),n.Q6J("routerLink",n.VKq(5,Wt,o.id)),n.xp6(1),n.hij(" ",o.display_name," "),n.xp6(2),n.hij(" @",o.username," "),n.xp6(3),n.hij(" ",o.body," "))},directives:[S.rH],styles:[""]}),t})();function Mt(t,e){if(1&t&&n._UZ(0,"app-card-noti",11),2&t){const i=e.$implicit;n.s9C("id",null==i||null==i.user_Writer?null:i.user_Writer.id),n.s9C("username",null==i||null==i.user_Writer?null:i.user_Writer.username),n.s9C("display_name",null==i||null==i.user_Writer?null:i.user_Writer.display_name),n.s9C("image",null==i||null==i.user_Writer?null:i.user_Writer.image),n.s9C("unicode",null==i?null:i.unicodeNoti)}}const Ht=[{path:"",component:(()=>{class t{constructor(i,o,r){this.apollo=i,this.store=o,this.notiService=r,this.notis$=this.notiService.NotisByUser$,this.UserSlice$=this.store.select((0,f.P1)(w.iv,s=>s)),this.apiHelperSlice$=this.store.select((0,f.P1)(d.iv,s=>s))}ngOnInit(){new vt.N0,this.stateObserver=this.UserSlice$.pipe((0,h.b)(o=>{this.idUser=o.id,this.username=o.username,this.display_name=o.display_name,this.image=o.image})).subscribe(),this.stateObserverAPI=this.apiHelperSlice$.pipe((0,h.b)(o=>{this.page=o.NotificationsPage,o.NotificationsisLoading||(this.store.dispatch(d.$("0")),this.store.dispatch(d.f1(!0)),this.notiService.getNotisByUserData(this.idUser,this.page))})).subscribe()}ngOnDestroy(){this.stateObserverAPI.unsubscribe(),this.stateObserver.unsubscribe()}onScrollDown(){}onMoreData(){this.page=(Number(this.page)+1).toString(),this.store.dispatch(d.$(this.page)),this.notiService.getNotisByUserData(this.idUser,this.page)}}return t.\u0275fac=function(i){return new(i||t)(n.Y36(x._M),n.Y36(f.yh),n.Y36(Nt))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-noti"]],decls:13,vars:7,consts:[[1,"md:flex","md:h-screen","bg-dim-700"],[1,"w-full","md:flex-none","md:w-1/4","md:h-screen"],[3,"idUser","username","display_name","image"],["infiniteScroll","",1,"flex-grow","border-r-2","border-l-2","bg-dim-600","border-gray-500","overflow-y-scroll",3,"scrolled"],["title","Notifications"],[1,"h-full"],[3,"id","username","display_name","image","unicode",4,"ngFor","ngForOf"],[1,"flex","justify-center"],[1,"my-4","px-4","py-2","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"click"],[1,"flex-none","lg:w-1/4","h-screen","hidden","lg:flex"],[1,"w-full"],[3,"id","username","display_name","image","unicode"]],template:function(i,o){1&i&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"app-side-bar-left",2),n.qZA(),n.TgZ(3,"div",3),n.NdJ("scrolled",function(){return o.onScrollDown()}),n._UZ(4,"app-navigation-bar",4),n.TgZ(5,"div",5),n.YNc(6,Mt,1,5,"app-card-noti",6),n.ALo(7,"async"),n.TgZ(8,"div",7),n.TgZ(9,"button",8),n.NdJ("click",function(){return o.onMoreData()}),n._uU(10,"More"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(11,"div",9),n._UZ(12,"app-side-bar-right",10),n.qZA(),n.qZA()),2&i&&(n.xp6(2),n.s9C("idUser",o.idUser),n.s9C("username",o.username),n.s9C("display_name",o.display_name),n.s9C("image",o.image),n.xp6(4),n.Q6J("ngForOf",n.lcZ(7,5,o.notis$)))},directives:[Zt.S,yt,Ut.g,m.sg,Et.W,xt],pipes:[m.Ov],styles:[".main-panel[_ngcontent-%COMP%]{height:400px;overflow-y:scroll}"]}),t})()}];let Pt=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[S.Bz.forChild(Ht)],S.Bz]}),t})();var It=l(6005),Ot=l(329),Vt=l(6181);let Ft=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[m.ez,S.Bz]]}),t})(),Kt=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[m.ez,Pt,It.u,Ot.d,Vt.o,Ft,St,f.Aw.forFeature(d.u2,d.ZP),f.Aw.forFeature(w.u2,w.ZP)]]}),t})()}}]);