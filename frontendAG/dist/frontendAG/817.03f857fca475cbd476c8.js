"use strict";(self.webpackChunkfrontend_ag=self.webpackChunkfrontend_ag||[]).push([[817],{7817:(G,b,r)=>{r.r(b),r.d(b,{ProfileModule:()=>j});var c=r(8583),p=r(5218),g=r(8741),d=r(3342),u=r(5257),m=r(5858),y=r(8115),n=r(5128),e=r(7716),v=r(42),h=r(3980),F=r(8613),P=r(1615),Z=r(4956),O=r(8391),C=r(2996),x=r(2340),U=r(2608);const I=function(s){return{isFollowing:s}};function S(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().onFollow()}),e._uU(1),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,I,t.isFollow)),e.xp6(1),e.Oqu(t.textFollow)}}function D(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().onSendMessage()}),e._uU(1," Send Message"),e._UZ(2,"svg-icon",17),e.qZA()}}let T=(()=>{class s{constructor(t,o,l){this.apollo=t,this.store=o,this.router=l,this.url=x.N.apiUrl,this.isOwner=!0,this.isFollow=!1,this.textFollow="Follow",this.apiHelperSlice$=this.store.select((0,h.P1)(n.iv,a=>a))}ngOnInit(){if(this.IdUser!=this.IdtoFollow)try{const t=g.Ps`
        query followByUsers($Following:String!,$Follower:String!){
          followByUsers(user_Owner:$Following,user_follwing:$Follower){
           id
          }
        }`;this.apollo.watchQuery({query:t,variables:{Follower:this.IdUser,Following:this.IdtoFollow},fetchPolicy:"network-only"}).valueChanges.pipe((0,u.q)(1),(0,d.b)(({data:o})=>{null!=o.followByUsers&&(this.idFollow=o.followByUsers.id,this.isFollow=!0,this.textFollow="Following")},o=>{console.log("there was an error sending the query",o)})).subscribe()}catch(t){console.log(t)}}onFollow(){try{if(this.isFollow){const t=g.Ps`
        mutation deleteFollows($ID:String!,$Following:String!,$Follower:String!) {
          deleteFollows(id:$ID,user_Owner:$Following,user_follwing:$Follower)
          }
        `;this.apollo.mutate({mutation:t,variables:{ID:this.idFollow,Follower:this.IdUser,Following:this.IdtoFollow}}).pipe((0,u.q)(1),(0,d.b)(({})=>{this.followers=(Number(this.followers)-1).toString(),this.idFollow="null",this.isFollow=!1,this.textFollow="Follow"},o=>{console.log("there was an error sending the query",o)})).subscribe()}else{const t=g.Ps`
        mutation addFollows($Following:String!,$Follower:String!){
          addFollows(user_Owner:$Following,user_follwing:$Follower){
            id
          }
        }`;this.apollo.mutate({mutation:t,variables:{Follower:this.IdUser,Following:this.IdtoFollow}}).pipe((0,u.q)(1),(0,d.b)(({data:o})=>{this.followers=(Number(this.followers)+1).toString(),this.textFollow="Following",this.isFollow=!0,this.idFollow=o.addFollows.id},o=>{console.log("there was an error sending the query",o)})).subscribe()}}catch(t){console.log(t)}}onSendMessage(){try{this.getChatcode(this.IdtoFollow,this.IdUser)}catch(t){console.log(t)}}getChatcode(t,o){try{const l=g.Ps`
      query user_follwing($Owner: String!,$Chat:String!){ 
        chatByUser(user_Owner:$Owner,user_Chat:$Chat){
          id
          chatcode
        }
      }
    `;this.apollo.watchQuery({query:l,variables:{Owner:t,Chat:o},fetchPolicy:"network-only"}).valueChanges.pipe((0,u.q)(1),(0,C.j)("data","chatByUser"),(0,d.b)(a=>{null===a?(this.createChat(t,o,o+t),this.createChat(o,t,o+t)):(this.router.navigate(["/messages"]),this.store.dispatch(n.FG(a.chatcode)))},a=>{console.log("there was an error sending the query",a)})).subscribe()}catch(l){console.log(l)}}createChat(t,o,l){try{const a=g.Ps`
      mutation addChat($Owner: String!,$Chat:String!,$CHATCode:String!){ 
          addChat(user_Owner:$Owner,user_Chat:$Chat,chatcode:$CHATCode){
          id
          chatcode
        }
      }
    `;this.apollo.mutate({mutation:a,variables:{Owner:t,Chat:o,CHATCode:l},fetchPolicy:"network-only"}).pipe((0,u.q)(1),(0,C.j)("data","addChat"),(0,d.b)(f=>{this.router.navigate(["/messages"]),this.store.dispatch(n.FG(f.chatcode))},f=>{console.log("there was an error sending the query",f)})).subscribe()}catch(a){console.log(a)}}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(v._M),e.Y36(h.yh),e.Y36(p.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-profile-card"]],inputs:{IdUser:"IdUser",IdtoFollow:"IdtoFollow",isOwner:"isOwner",isFollow:"isFollow",username:"username",display_name:"display_name",image:"image",description:"description",following:"following",followers:"followers"},decls:23,vars:8,consts:[[1,"w-full","p-3","bg-dim-700","border-b-2","border-gray-600"],[1,"flex","relative"],[1,"mx-4","my-3"],["alt","",1,"h-28","w-28","rounded-full",3,"src"],[1,"flex-col"],[1,"mt-9","text-xl","text-white"],[1,"text-lg","text-gray-400"],["class","absolute right-4 mt-8 p-2 pl-5 pr-5 bg-transparent border-2 border-blue-500 text-blue-500 text-lg rounded-full hover:bg-blue-500 hover:text-gray-100 focus:border-4 focus:border-blue-300",3,"ngClass","click",4,"ngIf"],["class","absolute bottom-0 right-4 mt-2 p-2 pl-5 pr-5 bg-transparent border-2 border-blue-500 text-blue-500 text-lg rounded-full hover:bg-blue-500 hover:text-gray-100 focus:border-4 focus:border-blue-300",3,"click",4,"ngIf"],[1,"mx-5","my-2"],[1,"text-lg","text-gray-200"],[1,"flex","mx-5","my-4"],[1,"pr-2","text-lg","text-gray-400"],[1,"text-white"],[1,"pl-2","text-lg","text-gray-400"],[1,"absolute","right-4","mt-8","p-2","pl-5","pr-5","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"ngClass","click"],[1,"absolute","bottom-0","right-4","mt-2","p-2","pl-5","pr-5","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"click"],["key","messages","color","white","fontSize","20px"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"img",3),e.qZA(),e.TgZ(4,"div",4),e.TgZ(5,"h2",5),e._uU(6),e.qZA(),e.TgZ(7,"h2",6),e._uU(8),e.qZA(),e.qZA(),e.YNc(9,S,2,4,"button",7),e.YNc(10,D,3,0,"button",8),e.qZA(),e.TgZ(11,"div",9),e.TgZ(12,"h2",10),e._uU(13),e.qZA(),e.qZA(),e.TgZ(14,"div",11),e.TgZ(15,"h2",12),e.TgZ(16,"span",13),e._uU(17),e.qZA(),e._uU(18," Following"),e.qZA(),e.TgZ(19,"h2",14),e.TgZ(20,"span",13),e._uU(21),e.qZA(),e._uU(22," Followers"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.MGl("src","",o.url+"cdn/user/"+o.image," ",e.LSH),e.xp6(3),e.Oqu(o.display_name),e.xp6(2),e.Oqu(o.username),e.xp6(1),e.Q6J("ngIf",!o.isOwner),e.xp6(1),e.Q6J("ngIf",!o.isOwner),e.xp6(3),e.Oqu(o.description),e.xp6(4),e.Oqu(o.following),e.xp6(4),e.Oqu(o.followers))},directives:[c.O5,c.mk,U.bk],styles:[".isFollowing[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgba(243,244,246,var(--tw-text-opacity));--tw-bg-opacity: 1;background-color:rgba(59,130,246,var(--tw-bg-opacity))}"]}),s})();var A=r(9960),$=r(8559),q=r(1834);function M(s,i){if(1&s&&e._UZ(0,"app-new-post",13),2&s){const t=e.oxw();e.s9C("idUserOwner",t.IdUserProfile)}}function B(s,i){if(1&s&&e._UZ(0,"app-card-post",14),2&s){const t=i.$implicit,o=e.oxw();e.s9C("idUser",o.UserData.id),e.s9C("idUserPost",o.IdUserProfile),e.s9C("display_name",o.display_name),e.s9C("username",o.username),e.s9C("imageUser",o.image),e.s9C("idPost",t.id),e.s9C("title",t.title),e.s9C("body",t.body),e.s9C("image",t.image),e.s9C("nLike",t.nLike),e.s9C("nComment",t.nComment),e.Q6J("isOwner",o.isOwner)}}const H=[{path:"",component:(()=>{class s{constructor(t,o,l,a,f){this.apollo=t,this.store=o,this.route=l,this.userService=a,this.postService=f,this.post$=this.postService.postByUser$,this.isOwner=!1,this.UserSlice$=this.store.select((0,y.P1)(m.iv,w=>w)),this.apiHelperSlice$=this.store.select((0,y.P1)(n.iv,w=>w))}ngOnInit(){this.stateObserver=this.UserSlice$.pipe((0,d.b)(t=>{this.UserData=t})).subscribe(),this.route.params.pipe((0,u.q)(1),(0,d.b)(({id:t})=>{this.IdUserProfile=t})).subscribe(),this.getDataUser(this.IdUserProfile),this.stateObserverAPI=this.apiHelperSlice$.pipe((0,d.b)(t=>{this.page=t.ProfilePostPage,t.ProfilePostisLoading||t.ProfilePostIdUser==this.IdUserProfile?t.ProfilePostIdUser!=this.IdUserProfile&&(this.postService.clearPostByUserData(),this.store.dispatch(n.WD(this.IdUserProfile)),this.store.dispatch(n.fH("0")),this.store.dispatch(n.M9(!0)),this.postService.getPostByUserData(this.IdUserProfile,this.page)):(this.postService.clearPostByUserData(),this.store.dispatch(n.WD(this.IdUserProfile)),this.store.dispatch(n.fH("0")),this.store.dispatch(n.M9(!0)),this.postService.getPostByUserData(this.IdUserProfile,this.page))})).subscribe(),this.getFollowersData(this.IdUserProfile),this.getFollowingData(this.IdUserProfile)}ngOnDestroy(){this.stateObserver.unsubscribe(),this.stateObserverAPI.unsubscribe()}onMoreData(){this.page=(Number(this.page)+1).toString(),this.store.dispatch(n.fH(this.page)),this.postService.getPostByUserData(this.IdUserProfile,this.page)}onMoreDataClear(){this.postService.clearPostByUserData()}getDataUser(t){try{const o=g.Ps`
      query Users($id:String!){
        user(id: $id){
          username
          email
          display_name
          password
          description
          image
        }
      }
      `;this.apollo.watchQuery({query:o,variables:{id:t},fetchPolicy:"network-only"}).valueChanges.pipe((0,u.q)(1),(0,d.b)(({data:l})=>{this.UserData.username==l.user.username&&(this.isOwner=!0),this.username=l.user.username,this.display_name=l.user.display_name,this.image=l.user.image,this.description=l.user.description},l=>{console.log("there was an error sending the query",l)})).subscribe()}catch(o){console.log(o)}}getFollowingData(t){try{const o=g.Ps`
      query countFollowings($id: String!) {
        countFollowings(id:$id)
      }
    `;this.apollo.watchQuery({query:o,variables:{id:t}}).valueChanges.pipe((0,u.q)(1),(0,d.b)(({data:l})=>{this.following=l.countFollowings},l=>{console.log("there was an error sending the query",l)})).subscribe()}catch(o){console.log(o)}}getFollowersData(t){try{const o=g.Ps`
      query countFollowers($id: String!) {
        countFollowers(id:$id)
      }
    `;this.apollo.watchQuery({query:o,variables:{id:t}}).valueChanges.pipe((0,u.q)(1),(0,d.b)(({data:l})=>{this.followers=l.countFollowers},l=>{console.log("there was an error sending the query",l)})).subscribe()}catch(o){console.log(o)}}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(v._M),e.Y36(h.yh),e.Y36(p.gz),e.Y36(F.K),e.Y36(P.L))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-profile"]],decls:15,vars:17,consts:[[1,"md:flex","md:h-screen","bg-dim-700"],[1,"w-full","md:flex-none","md:w-1/4","md:h-screen"],[3,"idUser","username","display_name","image"],[1,"flex-grow","h-screen","border-r-2","border-l-2","bg-dim-600","border-gray-500","overflow-y-auto"],[1,"flex-col"],["title","Profile"],[3,"IdUser","isOwner","IdtoFollow","display_name","username","image","description","following","followers"],[3,"idUserOwner",4,"ngIf"],[3,"isOwner","idUser","idUserPost","display_name","username","imageUser","idPost","title","body","image","nLike","nComment",4,"ngFor","ngForOf"],[1,"flex","justify-center"],[1,"my-4","px-4","py-2","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"click"],[1,"flex-none","lg:w-1/4","h-screen","hidden","lg:flex"],[1,"w-full"],[3,"idUserOwner"],[3,"isOwner","idUser","idUserPost","display_name","username","imageUser","idPost","title","body","image","nLike","nComment"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"app-side-bar-left",2),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e._UZ(5,"app-navigation-bar",5),e._UZ(6,"app-profile-card",6),e.YNc(7,M,1,1,"app-new-post",7),e.YNc(8,B,1,12,"app-card-post",8),e.ALo(9,"async"),e.TgZ(10,"div",9),e.TgZ(11,"button",10),e.NdJ("click",function(){return o.onMoreData()}),e._uU(12,"More"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",11),e._UZ(14,"app-side-bar-right",12),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.s9C("idUser",null==o.UserData?null:o.UserData.id),e.s9C("username",null==o.UserData?null:o.UserData.username),e.s9C("display_name",null==o.UserData?null:o.UserData.display_name),e.s9C("image",null==o.UserData?null:o.UserData.image),e.xp6(4),e.s9C("IdUser",o.IdUserProfile),e.s9C("IdtoFollow",o.UserData.id),e.s9C("display_name",o.display_name),e.s9C("username",o.username),e.s9C("image",o.image),e.s9C("description",o.description),e.s9C("following",o.following),e.s9C("followers",o.followers),e.Q6J("isOwner",o.isOwner),e.xp6(1),e.Q6J("ngIf",o.IdUserProfile==(null==o.UserData?null:o.UserData.id)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(9,15,o.post$)))},directives:[Z.S,O.g,T,c.O5,c.sg,A.W,$.Y,q.D],pipes:[c.Ov],styles:[""]}),s})()}];let L=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[p.Bz.forChild(H)],p.Bz]}),s})();var J=r(6005),Y=r(6181),Q=r(329),E=r(4253);let N=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[c.ez,p.Bz,U.Kz,h.Aw.forFeature(n.u2,n.ZP)]]}),s})();var z=r(4998);let j=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[c.ez,L,J.u,Y.o,Q.d,E.m,N,z.H,h.Aw.forFeature(n.u2,n.ZP),h.Aw.forFeature(m.u2,m.ZP)]]}),s})()}}]);