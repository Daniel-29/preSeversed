"use strict";(self.webpackChunkfrontend_ag=self.webpackChunkfrontend_ag||[]).push([[330],{2330:(x,P,o)=>{o.r(P),o.d(P,{PostModule:()=>$});var g=o(8583),p=o(5218),a=o(665),f=o(8741),e=o(2340),h=o(5257),v=o(3342),u=o(5858),y=o(8115),t=o(7716),U=o(42),O=o(3980),T=o(1615),b=o(9344),S=o(4956),Z=o(8391),E=o(1834),D=o(9960),m=o(3684);function _(l,c){if(1&l&&t._UZ(0,"app-received-message",22),2&l){const i=c.$implicit;t.s9C("username",null==i||null==i.user_Action?null:i.user_Action.username),t.MGl("body"," ",i.body,""),t.s9C("image",null==i||null==i.user_Action?null:i.user_Action.image)}}function r(l,c){1&l&&(t.TgZ(0,"span",23),t._uU(1," Invalid text for comments!. "),t.qZA())}const C=[{path:"",component:(()=>{class l{constructor(i,s,d,L,R){this.apollo=i,this.store=s,this.route=d,this.postService=L,this.toastr=R,this.isOwner=!1,this.comments$=this.postService.commentsByPost$,this.page="0",this.formComment=new a.cw({body:new a.NI("",[a.kI.required,a.kI.minLength(1),a.kI.maxLength(80),a.kI.pattern(e.N.TextValidation)])}),this.UserSlice$=this.store.select((0,y.P1)(u.iv,N=>N))}ngOnInit(){this.route.params.pipe((0,h.q)(1),(0,v.b)(({id:i})=>{this.IdPost=i})).subscribe(),this.stateObserver=this.UserSlice$.pipe((0,v.b)(i=>{this.UserData=i})).subscribe(),this.getPostByIdData(this.IdPost),this.postService.clearCommentsByPostData(),this.postService.getCommentsByPostData(this.IdPost,this.page)}ngOnDestroy(){this.stateObserver.unsubscribe()}onMoreData(){this.page=(Number(this.page)+1).toString(),this.postService.getCommentsByPostData(this.IdPost,this.page)}getPostByIdData(i){try{const s=f.Ps`
      query postsByUser($id: String!) {
        post(id:$id){
          id
          title
          body
          image
          nLike
          nComment
          tags
          user_Owner{
            id
            username
            display_name
            image
          }
      }
    }
    `;this.apollo.watchQuery({query:s,variables:{id:i},fetchPolicy:"network-only"}).valueChanges.pipe((0,h.q)(1),(0,v.b)(({data:d})=>{d.post.user_Owner.id===this.UserData.id&&(this.isOwner=!0);const L={id:d.post.id,title:d.post.title,body:d.post.body,image:d.post.image,nLike:d.post.nLike,nComment:d.post.nComment,tags:d.post.tags};this.User_username=d.post.user_Owner.username,this.User_display_name=d.post.user_Owner.display_name,this.User_image=d.post.user_Owner.image,this.nComment=d.post.nComment,this.User_id=d.post.user_Owner.id,this.post=L},d=>{console.log("there was an error sending the query",d)})).subscribe()}catch(s){console.log(s)}}addCommentToPost(){try{if(this.formComment.markAsTouched(),this.formComment.valid){const i=f.Ps`
        mutation postsByUser($BODY: String!,$POST:String!,$USER:String!,$NCOMMENT:String!,$USER_POST:String!) {
        addComment(body:$BODY,post_Owner:$POST,user_Action:$USER,NComment:$NCOMMENT,user_Post_Owner:$USER_POST) {
          id
          body
          user_Action{
            id
            username
            image
          }
        }
      }
      `;this.apollo.mutate({mutation:i,variables:{BODY:this.formComment.controls.body.value,POST:this.IdPost,USER:this.UserData.id,NCOMMENT:(Number(this.nComment)+1).toString(),USER_POST:this.User_id},fetchPolicy:"network-only"}).pipe((0,h.q)(1),(0,v.b)(({data:s})=>{this.postService.addCommentToPost(s.addComment),this.formComment.controls.body.setValue(""),this.nComment=(Number(this.nComment)+1).toString(),this.formComment.markAsUntouched(),this.formComment.reset(),this.formComment.controls.body.setValue(""),this.toastr.success("comment send","info!",{closeButton:!0,progressBar:!0,timeOut:1500})},s=>{console.log("there was an error sending the query",s)})).subscribe()}else this.toastr.warning("Invalid data","warning!",{closeButton:!0,progressBar:!0,timeOut:1500})}catch(i){console.log(i)}}}return l.\u0275fac=function(i){return new(i||l)(t.Y36(U._M),t.Y36(O.yh),t.Y36(p.gz),t.Y36(T.L),t.Y36(b._W))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-post"]],decls:25,vars:24,consts:[[1,"md:flex","md:h-screen","bg-dim-700"],[1,"w-full","md:flex-none","md:w-1/4","md:h-screen"],[3,"idUser","username","display_name","image"],[1,"flex-grow","h-screen","border-r-2","border-l-2","bg-dim-600","border-gray-500","overflow-y-auto"],[1,"flex-col"],["title","Post"],[3,"isOwner","idUser","idUserPost","display_name","username","imageUser","idPost","title","body","image","nLike","nComment"],[1,"relative","h-full","w-full"],[1,"h-full","overflow-y-auto","text-white"],[1,"flex","flex-col","py-6","px-10","overscroll-x-none"],["class","overflow-ellipsis overflow-hidde ",3,"username","body","image",4,"ngFor","ngForOf"],[1,"flex","justify-center"],[1,"my-4","px-4","py-2","bg-transparent","border-2","border-blue-500","text-blue-500","text-lg","rounded-full","hover:bg-blue-500","hover:text-gray-100","focus:border-4","focus:border-blue-300",3,"click"],[1,"sticky","top-0","inset-x-0","bottom-0","h-20","px-8","bg-dim-700"],[1,"h-full","flex",3,"formGroup","ngSubmit"],[1,"self-center","sm:flex","bg-white","rounded-lg","w-full"],["formControlName","body","type","text","placeholder","New Comment",1,"text-base","flex-grow","outline-none","px-2"],[1,"ms:flex","items-center","rounded-lg","space-x-4","mx-auto"],["type","submit",1,"px-4","py-2","text-white","font-bold","rounded-md","bg-indigo-400","hover:bg-blue-500",3,"disabled"],["class","flex items-center font-medium tracking-wide text-red-500 text-xs mt-1 ml-1",4,"ngIf"],[1,"flex-none","lg:w-1/4","h-screen","hidden","lg:flex"],[1,"w-full"],[1,"overflow-ellipsis","overflow-hidde",3,"username","body","image"],[1,"flex","items-center","font-medium","tracking-wide","text-red-500","text-xs","mt-1","ml-1"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._UZ(2,"app-side-bar-left",2),t.qZA(),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t._UZ(5,"app-navigation-bar",5),t._UZ(6,"app-card-post",6),t.TgZ(7,"div",7),t.TgZ(8,"div",8),t.TgZ(9,"div",9),t.YNc(10,_,1,3,"app-received-message",10),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"div",11),t.TgZ(13,"button",12),t.NdJ("click",function(){return s.onMoreData()}),t._uU(14,"More"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"div",13),t.TgZ(16,"form",14),t.NdJ("ngSubmit",function(){return s.addCommentToPost()}),t.TgZ(17,"div",15),t._UZ(18,"input",16),t.TgZ(19,"div",17),t.TgZ(20,"button",18),t._uU(21,"Send"),t.qZA(),t.qZA(),t.qZA(),t.YNc(22,r,2,0,"span",19),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div",20),t._UZ(24,"app-side-bar-right",21),t.qZA(),t.qZA()),2&i&&(t.xp6(2),t.s9C("idUser",null==s.UserData?null:s.UserData.id),t.s9C("username",null==s.UserData?null:s.UserData.username),t.s9C("display_name",null==s.UserData?null:s.UserData.display_name),t.s9C("image",null==s.UserData?null:s.UserData.image),t.xp6(4),t.s9C("idUser",s.UserData.id),t.s9C("idUserPost",s.User_id),t.s9C("display_name",s.User_display_name),t.s9C("username",s.User_username),t.s9C("imageUser",s.User_image),t.s9C("idPost",s.IdPost),t.s9C("title",null==s.post?null:s.post.title),t.s9C("body",null==s.post?null:s.post.body),t.s9C("image",null==s.post?null:s.post.image),t.s9C("nLike",null==s.post?null:s.post.nLike),t.s9C("nComment",s.nComment),t.Q6J("isOwner",!1),t.xp6(4),t.Q6J("ngForOf",t.lcZ(11,22,s.comments$)),t.xp6(6),t.Q6J("formGroup",s.formComment),t.xp6(4),t.ekj("bg-disabled",s.formComment.controls.body.invalid&&s.formComment.controls.body.touched),t.Q6J("disabled",s.formComment.controls.body.invalid),t.xp6(2),t.Q6J("ngIf",s.formComment.controls.body.invalid&&""!=s.formComment.controls.body.value))},directives:[S.S,Z.g,E.D,g.sg,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,g.O5,D.W,m.n],pipes:[g.Ov],styles:[".bg-disabled[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgba(123,121,125,var(--tw-bg-opacity))}"]}),l})()}];let A=(()=>{class l{}return l.\u0275fac=function(i){return new(i||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[[p.Bz.forChild(C)],p.Bz]}),l})();var M=o(6005),I=o(329),B=o(6181),k=o(4253),w=o(911);let $=(()=>{class l{}return l.\u0275fac=function(i){return new(i||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[[g.ez,A,B.o,M.u,I.d,k.m,w.n,a.UX,O.Aw.forFeature(u.u2,u.ZP)]]}),l})()},1834:(x,P,o)=>{o.d(P,{D:()=>D});var g=o(8741),p=o(5257),a=o(3342),f=o(2340),e=o(7716),h=o(42),v=o(9344),u=o(1615),y=o(3980),t=o(5218),U=o(8583),O=o(2608);function T(m,_){if(1&m){const r=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"button",22),e.NdJ("click",function(){return e.CHM(r),e.oxw().onDeletePost()}),e._UZ(2,"svg-icon",23),e.qZA(),e.qZA()}}function b(m,_){if(1&m&&(e.TgZ(0,"div",24),e._UZ(1,"img",25),e.qZA()),2&m){const r=e.oxw();e.xp6(1),e.s9C("src",r.url+"cdn/post/"+r.image,e.LSH)}}const S=function(m){return["/profile",m]},Z=function(m){return{myRed:m}},E=function(m){return["/post",m]};let D=(()=>{class m{constructor(r,n,C,A){this.apollo=r,this.toastr=n,this.postService=C,this.store=A,this.url=f.N.apiUrl,this.isCommented=!1}ngOnInit(){this.loadLiked()}ngOnDestroy(){}loadLiked(){try{const r=g.Ps`
      query likeToPostByUser($post:String!,$user:String!){
        likeToPostByUser(post_Owner:$post,user_Action:$user) {
          id
          like
        }
      }
    `;this.apollo.watchQuery({query:r,variables:{post:this.idPost,user:this.idUser},fetchPolicy:"network-only"}).valueChanges.pipe((0,p.q)(1),(0,a.b)(({data:n})=>{null!==n.likeToPostByUser&&(this.isLiked=!0,this.idLiked=n.likeToPostByUser.id)},n=>{console.log("there was an error sending the query",n)})).subscribe()}catch(r){console.log(r)}}LikerDislikear(){try{if(this.isLiked){const r=g.Ps`
        mutation deleteLike($ID:String!,$POST:String!,$NLIKE:String!,$USER_POST:String!,$USER_SESSION:String!) {
          deleteLike(id:$ID,post_Owner:$POST,nLikeCount:$NLIKE,user_Post_Owner:$USER_POST,user_Action:$USER_SESSION)
          }
        `;this.apollo.mutate({mutation:r,variables:{ID:this.idLiked,POST:this.idPost,NLIKE:(Number(this.nLike)-1).toString(),USER_POST:this.idUserPost,USER_SESSION:this.idUser}}).pipe((0,p.q)(1),(0,a.b)(({})=>{this.idLiked="",this.isLiked=!1,this.nLike=(Number(this.nLike)-1).toString()},n=>{console.log("there was an error sending the query",n)})).subscribe()}else{const r=g.Ps`
      mutation addLike($post:String!,$user:String!,$nlike:String!,$USER_POST:String!) {
          addLike(like:"true",post_Owner:$post,user_Action:$user,nLikeCount:$nlike,user_Post_Owner:$USER_POST){
            id
          }
        }
      `;this.apollo.mutate({mutation:r,variables:{post:this.idPost,user:this.idUser,nlike:(Number(this.nLike)+1).toString(),USER_POST:this.idUserPost}}).pipe((0,p.q)(1),(0,a.b)(({data:n})=>{this.idLiked=n.addLike.id,this.isLiked=!0,this.nLike=(Number(this.nLike)+1).toString()},n=>{console.log("there was an error sending the query",n)})).subscribe()}}catch(r){console.log(r)}}onDeletePost(){try{const r=g.Ps`
      mutation deletePost($deletePostId: String!){
          deletePost(id: $deletePostId)
        }
      `;this.apollo.mutate({mutation:r,variables:{deletePostId:this.idPost}}).pipe((0,p.q)(1),(0,a.b)(({})=>{this.postService.clearPostByUserData(),this.postService.getPostByUserData(this.idUser.toString(),"0"),this.toastr.success("post deleted successfully","success!",{closeButton:!0,progressBar:!0,timeOut:1500})},n=>{console.log("there was an error sending the query",n)})).subscribe()}catch(r){console.log(r)}}}return m.\u0275fac=function(r){return new(r||m)(e.Y36(h._M),e.Y36(v._W),e.Y36(u.L),e.Y36(y.yh))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-card-post"]],inputs:{isOwner:"isOwner",display_name:"display_name",idUser:"idUser",idUserPost:"idUserPost",username:"username",imageUser:"imageUser",idPost:"idPost",title:"title",body:"body",image:"image",nLike:"nLike",nComment:"nComment",tags:"tags"},decls:31,vars:18,consts:[[1,"w-full","border-b-2","border-gray-500"],[1,"flex-col"],[1,"flex","p-4","pb-0","w-full","relative"],[1,"flex-shrink-0","group","block"],[1,"flex","items-center"],["alt","",1,"inline-block","h-10","w-10","rounded-full",3,"src"],[1,"ml-3"],[1,"text-base","hover:underline","cursor-pointer","leading-6","font-medium","text-white",3,"routerLink"],[1,"text-sm","leading-5","font-medium","transition","ease-in-out","duration-100"],["class","flex absolute right-2 ",4,"ngIf"],[1,"w-full","py-2","px-6"],[1,"font-semibold","text-xl","text-white"],[1,"text-base","overflow-y-auto","font-medium","text-gray-300"],["class"," px-6 pt-3",4,"ngIf"],[1,"grid","grid-cols-2","justify-center","py-3","w-full"],[1,"flex","justify-center"],[1,"flex","hover:text-red-600","text-white",3,"ngClass","click"],["key","heart","color","hover:text-red-600","fontSize","28px",1,""],[1,"pl-3"],[1,"flex","hover:text-green-600","text-white",3,"routerLink"],["key","comments","color","hover:text-red-600","fontSize","28px",1,""],[1,"flex","absolute","right-2"],[1,"flex","hover:text-red-600","text-white","px-2",3,"click"],["key","trash-can","color","hover:text-red-600","fontSize","28px",1,""],[1,"px-6","pt-3"],["alt","",1,"object-contain","max-h-screen","m","w-full",3,"src"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"a"),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"a",3),e.TgZ(5,"div",4),e.TgZ(6,"div"),e._UZ(7,"img",5),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"p",7),e._uU(10),e.TgZ(11,"span",8),e._uU(12),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(13,T,3,0,"div",9),e.qZA(),e.TgZ(14,"div",10),e.TgZ(15,"span",11),e._uU(16),e.qZA(),e.TgZ(17,"p",12),e._uU(18),e.qZA(),e.qZA(),e.YNc(19,b,2,1,"div",13),e.TgZ(20,"div",14),e.TgZ(21,"div",15),e.TgZ(22,"button",16),e.NdJ("click",function(){return n.LikerDislikear()}),e._UZ(23,"svg-icon",17),e.TgZ(24,"h2",18),e._uU(25),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"div",15),e.TgZ(27,"a",19),e._UZ(28,"svg-icon",20),e.TgZ(29,"h2",18),e._uU(30),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(7),e.s9C("src",n.url+"cdn/user/"+n.imageUser,e.LSH),e.xp6(2),e.Q6J("routerLink",e.VKq(12,S,n.idUserPost)),e.xp6(1),e.hij(" ",n.display_name," "),e.xp6(2),e.hij(" @",n.username," "),e.xp6(1),e.Q6J("ngIf",n.isOwner),e.xp6(3),e.Oqu(n.title),e.xp6(2),e.Oqu(n.body),e.xp6(1),e.Q6J("ngIf",""!=n.image),e.xp6(3),e.Q6J("ngClass",e.VKq(14,Z,n.isLiked)),e.xp6(3),e.Oqu(n.nLike),e.xp6(2),e.Q6J("routerLink",e.VKq(16,E,n.idPost)),e.xp6(3),e.Oqu(n.nComment))},directives:[t.rH,U.O5,U.mk,O.bk,t.yS],styles:[".myRed[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgba(220,38,38,var(--tw-text-opacity))}.myHover[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgba(255,255,255,var(--tw-text-opacity))}"]}),m})()},4253:(x,P,o)=>{o.d(P,{m:()=>v});var g=o(8583),p=o(5218),a=o(2608),f=o(5128),e=o(3980),h=o(7716);let v=(()=>{class u{}return u.\u0275fac=function(t){return new(t||u)},u.\u0275mod=h.oAB({type:u}),u.\u0275inj=h.cJS({imports:[[g.ez,p.Bz,a.Kz,e.Aw.forFeature(f.u2,f.ZP)]]}),u})()}}]);